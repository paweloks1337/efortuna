<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ğŸ† Ranking Mistrzostw Discorda 2025</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<style>
:root{--gold:#FFD700;--dark:#111;--green:#00FF88;--red:#FF4444}
body{margin:0;padding:0;font-family:'Poppins',sans-serif;background:linear-gradient(180deg,#000,#111);color:var(--gold);text-align:center;overflow-x:hidden}
nav{background:linear-gradient(90deg,#000,#222);padding:14px 0;box-shadow:0 2px 10px rgba(255,215,0,0.18)}
nav a{color:var(--gold);text-decoration:none;margin:0 18px;font-weight:600}
h1{margin:18px 0;text-shadow:0 0 12px var(--gold)}
.container{width:90%;max-width:860px;margin:36px auto;background:#1a1a1a;padding:18px;border-radius:14px;box-shadow:0 8px 30px rgba(0,0,0,0.6)}
.sort-box{margin:10px}
.sort-box select{background:#111;border:1px solid var(--gold);color:var(--gold);border-radius:8px;padding:6px 10px;font-weight:600}
#search{width:80%;max-width:340px;padding:10px;border-radius:8px;border:2px solid var(--gold);background:#000;color:var(--gold);margin:8px auto;display:block}

.table-wrap{overflow-x:auto;-webkit-overflow-scrolling:touch}

table{width:100%;border-collapse:collapse;margin-top:12px;min-width:650px}
th,td{padding:10px;border-bottom:1px solid rgba(255,255,255,0.05);text-align:left}
th{text-transform:uppercase;font-size:.9rem}
td.nick{color:#fff;font-weight:600;cursor:pointer}
td.points{color:var(--green);font-weight:700;text-align:right}
td.coupons{text-align:center}
td.reward{white-space:normal;line-height:1.25}

.stats{margin-top:18px;border-top:1px solid rgba(255,255,255,0.04);padding-top:14px;color:#ccc}
.stat-box{display:inline-block;margin:6px 18px}

/* ================= MOBILE FIX ================= */
@media (max-width:600px){
  .container{padding:10px}
  table{font-size:.82rem}
  th,td{padding:6px}
  td.reward{max-width:140px}
  td.nick{max-width:110px}
  td.points{font-size:.9rem}
  .stat-box{display:block;margin:6px 0}
}
</style>
</head>

<body>

<nav>
  <a href="index.html">ğŸ† Ranking</a>
  <a href="kalkulator.html">ğŸ“Š Kalkulator</a>
</nav>

<h1>ğŸ† Ranking Mistrzostw Discorda 2025</h1>

<input id="search" placeholder="ğŸ” Szukaj nicku..." />

<div class="sort-box">
  <select id="main-sort">
    <option value="points">ğŸ† PunktÃ³w</option>
    <option value="coupons">ğŸŸï¸ KuponÃ³w</option>
  </select>
</div>

<div class="container">
  <div class="table-wrap">
    <table id="ranking">
      <thead>
        <tr>
          <th>Miejsce</th>
          <th>Nick</th>
          <th>Nagroda</th>
          <th>Kupony</th>
          <th style="text-align:right">Punkty</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div class="stats">
    <div class="stat-box">ğŸ‘¥ Typerzy: <b id="count">0</b></div>
    <div class="stat-box">ğŸ’° Suma punktÃ³w: <b id="sum">0</b></div>
    <div class="stat-box">ğŸ“Š Åšrednia: <b id="avg">0</b></div>
  </div>
</div>

<script>
const CSV_URL="https://docs.google.com/spreadsheets/d/e/2PACX-1vQ9Zon74G75eqPkoElWkzBQuOTkG0zSL9bPzic_hdBZT3e0dMXnMBWAwCyu-tRpHxct203uZqQAoww0/pub?output=csv";
let list=[];

function parseCSV(t){return t.trim().split(/\r?\n/).map(l=>l.split(/,(?=(?:[^"]*"[^"]*")*[^"]*$)/).map(x=>x.replace(/^"|"$/g,'')))}

function getReward(p){
  if(p===1)return"ğŸ¥‡ 1000 zÅ‚";
  if(p===2)return"ğŸ¥ˆ 700 zÅ‚";
  if(p===3)return"ğŸ¥‰ 500 zÅ‚";
  if(p===4)return"ğŸ… 300 zÅ‚";
  if(p===5)return"ğŸ… 250 zÅ‚";
  if(p<=10)return"ğŸ 150 zÅ‚";
  if(p<=15)return"ğŸ 100 zÅ‚";
  if(p<=20)return"ğŸ 80 zÅ‚";
  if(p<=30)return"ğŸ 60 zÅ‚";
  if(p<=40)return"ğŸ 40 zÅ‚";
  if(p<=60)return"ğŸ 20 zÅ‚";
  return"";
}

async function load(){
  const r=await fetch(CSV_URL);
  const t=await r.text();
  const rows=parseCSV(t);
  const h=rows[0].map(x=>x.toLowerCase());
  const ni=h.findIndex(x=>x.includes("nick"));
  const pi=h.findIndex(x=>x.includes("punk"));
  rows.slice(1).forEach(r=>{
    const nick=r[ni];const pts=parseFloat(r[pi])||0;
    let p=list.find(x=>x.nick===nick);
    if(!p){p={nick,punkty:0,kupony:0};list.push(p);}
    p.punkty+=pts;p.kupony++;
  });
  render("points");
}

function render(s){
  const tb=document.querySelector("tbody");
  tb.innerHTML="";
  [...list].sort((a,b)=>s==="coupons"?b.kupony-a.kupony:b.punkty-a.punkty)
  .forEach((p,i)=>{
    tb.innerHTML+=`
    <tr>
      <td>${i+1}</td>
      <td class="nick">${p.nick}</td>
      <td class="reward">${getReward(i+1)}</td>
      <td class="coupons">${p.kupony}</td>
      <td class="points">${Math.round(p.punkty)}</td>
    </tr>`;
  });
}

document.getElementById("main-sort").onchange=e=>render(e.target.value);
window.onload=load;
</script>

</body>
</html>
