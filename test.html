<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TESTOWY TYPER</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans min-h-screen flex flex-col">

  <!-- Nagłówek -->
  <header class="flex justify-between items-center bg-white shadow-md p-4">
    <h1 class="text-2xl font-bold text-indigo-600">TESTOWY TYPER</h1>
    <div class="flex items-center space-x-3">
      <a id="login-btn" href="/test/login" class="px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700">Login przez Discord</a>
      <div id="avatar-box" class="hidden flex items-center space-x-2">
        <img id="user-avatar" src="" alt="Avatar" class="w-10 h-10 rounded-full border-2 border-indigo-600">
        <span id="user-name" class="font-medium text-gray-700"></span>
      </div>
    </div>
  </header>

  <!-- Nawigacja zakładek -->
  <nav class="bg-white shadow-md p-2 flex justify-center space-x-4">
    <button class="tab-btn px-4 py-2 font-medium rounded hover:bg-indigo-100" data-tab="typing">Typowanie</button>
    <button class="tab-btn px-4 py-2 font-medium rounded hover:bg-indigo-100" data-tab="history">Historia</button>
    <button class="tab-btn px-4 py-2 font-medium rounded hover:bg-indigo-100" data-tab="ranking">Ranking</button>
    <button class="tab-btn px-4 py-2 font-medium rounded hover:bg-indigo-100" data-tab="admin">Panel Admina</button>
  </nav>

  <!-- Sekcje zakładek -->
  <main class="flex-grow p-6">
    <section id="typing" class="tab-content">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">Typowanie meczów</h2>
      <div id="matches-container" class="space-y-4">
        <p class="text-gray-600">Tutaj będą wyświetlane mecze do typowania...</p>
      </div>
    </section>

    <section id="history" class="tab-content hidden">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">Twoja historia typów</h2>
      <div id="history-container" class="space-y-4">
        <p class="text-gray-600">Tutaj zobaczysz swoje wcześniejsze typy...</p>
      </div>
    </section>

    <section id="ranking" class="tab-content hidden">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">Ranking graczy</h2>
      <div id="ranking-container" class="space-y-2">
        <p class="text-gray-600">Tutaj pojawi się ranking punktów...</p>
      </div>
    </section>

    <section id="admin" class="tab-content hidden">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">Panel Admina</h2>
      <div id="admin-container" class="space-y-4">
        <p class="text-gray-600">Tylko dla adminów: dodawanie meczów, wpisywanie wyników itp.</p>
      </div>
    </section>
  </main>

  <footer class="bg-white shadow-inner p-4 text-center text-gray-500 text-sm">
    &copy; 2026 TESTOWY TYPER
  </footer>

  <!-- Skrypt -->
  <script>
    // Dane użytkownika z Node.js
    const user = window.USER || null;
    const adminIds = window.ADMIN_IDS || []; // Lista adminów z .env

    // Obsługa avatar + nick
    if(user){
      document.getElementById("login-btn").classList.add("hidden");
      const avatarBox = document.getElementById("avatar-box");
      avatarBox.classList.remove("hidden");
      document.getElementById("user-avatar").src = `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png`;
      document.getElementById("user-name").textContent = user.username;
    }

    // Obsługa zakładek
    const tabs = document.querySelectorAll(".tab-btn");
    const contents = document.querySelectorAll(".tab-content");

    tabs.forEach(tab => {
      tab.addEventListener("click", () => {
        const target = tab.dataset.tab;

        contents.forEach(c => {
          if(c.id === target) c.classList.remove("hidden");
          else c.classList.add("hidden");
        });

        // Panel admina widoczny tylko dla adminów
        if(target === "admin" && (!user || !adminIds.includes(user.id))){
          document.getElementById("admin-container").innerHTML = "<p class='text-red-500'>Brak dostępu. Tylko dla adminów.</p>";
        }
      });
    });

    // Domyślnie pokazujemy Typowanie
    document.querySelector(".tab-btn[data-tab='typing']").click();
  </script>
</body>
</html>
